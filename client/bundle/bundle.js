!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="/client/bundle",e(0)}([function(t,e,i){t.exports=i(30)},function(t,e,i){"use strict";var s=i(36);t.exports=s},function(t,e,i){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=i(1);e.getScaleMass=function(t){return 1-Math.sqrt(t)*n.scaleMassFactor},e.getPlayerSize=function(t){return n.playerInitSize+Math.sqrt(t)*n.playerFactor},e.getRingRadius=function(t){return n.ringInitSize+Math.sqrt(t)*n.ringFactor},e.getBallRadius=function(t){return n.ballInitSize+Math.sqrt(t)*n.ballFactor},e.getBallSize=function(t){return n.ballSpriteInitSize+Math.sqrt(t)*n.ballSpriteFactor},e.getBallPos=function(t,e,i,s){var n=t+i*Math.cos(s),a=e+i*Math.sin(s),r={x:n,y:a};return r},e.getRingSize=function(t){return n.ringInitSize+Math.sqrt(t)*n.ringFactor},e.getRingMin=function(t){return n.ringMinInitSize+Math.sqrt(t)*n.ringMinFactor},e.getRingMax=function(t){return n.ringMaxInitSize+Math.sqrt(t)*n.ringMaxFactor},e.getRingFreq=function(t){return n.ringFreqInit-Math.sqrt(t)*n.ringFreqFactor},e.getSelfScope=function(t){return n.selfScopeInitSize+Math.sqrt(t)*n.selfScopeFactor},e.getScope=function(t,e){return{maxScopeW:t.maxScopeWInit+this.getRingMax(e),maxScopeH:t.maxScopeHInit+this.getRingMax(e),minScopeW:t.minScopeWInit+this.getRingMax(e),minScopeH:t.minScopeHInit+this.getRingMax(e)}},e.getRandomPos=function(t,i,s){var a,r=Math.random();a=r<n.foodInsideProportion?e.randomIntFromInterval(0,Math.pow(t,2)):e.randomIntFromInterval(Math.pow(i,2),Math.pow(s,2));var o=Math.random()*Math.PI*2;return{x:Math.cos(o)*Math.sqrt(a),y:Math.sin(o)*Math.sqrt(a)}},e.randomIntFromInterval=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},e.inRect=function(t,e,i,s,n,a){return i-n/2<=t&&t<=i+n/2&&s-a/2<=e&&e<=s+a/2},e.distEucl=function(t,e,i,s){return Math.sqrt(Math.pow(i-t,2)+Math.pow(s-e,2))},e.idxOf=function(t,e,i){for(var s=-1,n=0;n<t.length;n++)if(t[n][e]===i){s=n;break}return s},e.abs=function(t){return t>=0?t:-t},e.round=function(t,e){var i=Math.pow(10,t);return Math.round(e*i)/i},e.sizeObject=function(t){for(var e=[],i=[t],n=0;i.length;){var a=i.pop();if("boolean"==typeof a)n+=4;else if("string"==typeof a)n+=2*a.length;else if("number"==typeof a)n+=8;else if("object"===("undefined"==typeof a?"undefined":s(a))&&e.indexOf(a)===-1){e.push(a);for(var r in a)i.push(a[r])}}return n}},function(t,e,i){"use strict";function s(t){this.id=t,this.state={},this.updates=[],this.visible=!1,setTimeout(function(){this.visible=!0}.bind(this),a.clientInterpolationTime),this.toRemove=!1}var n=i(5),a=i(1);e=t.exports=s,s.prototype={addUpdate:function(t,e){var i=new n(t,e);0===this.updates.length&&(this.state=i.state),this.updates.push(i),this.updates.length>a.clientMaxUpdateBuffer&&this.updates.splice(0,1)},setState:function(t){this.state=t},setToRemove:function(t){this.toRemove=t},getUpdates:function(){return this.updates},getInterpolatedUpdates:function(t){for(var e={},i=0;i<this.updates.length-1;i++){var s=this.updates[i],n=this.updates[i+1];if(t>=s.time&&t<n.time){e.previous=s,e.target=n;break}}return e},getId:function(){return this.id},isVisible:function(){return this.visible},isToRemove:function(){return this.toRemove}}},function(t,e,i){"use strict";function s(){this.entities=[],this.removedEntities=[]}var n=i(2),a=i(1);e=t.exports=s,s.prototype={removeEntity:function(t){var e=this.entities.indexOf(t);this.remove(e)},remove:function(t){t>=0&&(this.removedEntities.push(this.entities[t]),this.entities.splice(t,1))},clearEntities:function(){for(var t=this.entities.length;t--;)this.removedEntities.push(this.entities[t]),this.entities.splice(t,1)},clearRemovedEntities:function(){this.removedEntities=[]},getEntities:function(){return this.entities},getRemovedEntities:function(){return this.removedEntities},getEntityState:function(t){var e=!1;t===-1&&(e=a.spectatorInitState);var i=n.idxOf(this.entities,"id",t);return i>=0&&(e=this.entities[i].state),e}}},function(t,e){"use strict";function i(t,e){this.state=t,this.time=e}e=t.exports=i},function(t,e,i){"use strict";var s=i(1),n=i(7),a=i(2);e.getExtrapolatedPlayerState=function(t,e){var i={};return i.x=t.x,i.y=t.y,i.vx=t.vx,i.vy=t.vy,i.ring=t.ring,i.mass=t.mass,i.dashing=t.dashing,i.vy<s.playerVy&&(i.vy+=s.playerGravity*e),i.vy>s.playerVy&&(i.vy=s.playerVy),i.x+=i.vx*e,i.y+=i.vy*e,i};var r=function(t,e){var i=a.distEucl(0,0,t,e);return!!(i<=s.midLimitRad||i>=s.midLimitRad+s.midLimitStroke&&i<=s.endLimitRad||a.inRect(t,e,-(s.midLimitRad+s.midLimitStroke/2),0,s.midLimitStroke+100,s.tunnelHeight)||a.inRect(t,e,s.midLimitRad+s.midLimitStroke/2,0,s.midLimitStroke+100,s.tunnelHeight))},o=function(){return!1};e.getNewPlayerState=function(t,e,i){var n=t.id,r=t.state,l=i.getPlayerController(),d=i.getShootController(),c={};c.x=r.x,c.y=r.y,c.ring=r.ring,c.mass=r.mass,c.dashing=r.dashing,c.immunity=r.immunity,c.startTime=r.startTime,c.vx=r.vx,c.vy=r.vy,c.lastFlap=r.lastFlap,c.lastRing=r.lastRing,c.lastDash=r.lastDash,c.canDash=r.canDash,c.dashX=r.dashX,c.dashY=r.dashY,c.dashRange=r.dashRange,c.dashDone=r.dashDone;var u=a.getSelfScope(c.mass);if(h(t,c,i,d),f(c),c.immunity)return c;if(!g(c,e))return o();var p=i.getTiles(c.x,c.y,s.tileFoodRange,s.tileFoodRange);return x(c,p,u,t),c.dashing?c:S(c,i,l,u,n)?o():c};var h=function(t,e,i,n){s.debugMove&&(e.vx=0),t.pressLeft&&!e.dashing?l(e):t.pressRight&&!e.dashing?d(e):t.pressDash&&e.mass>=s.playerMinMassDash?c(t,e,n):t.pressClick&&p(i)},l=function(t){t.vx=-s.playerVx,t.vy=-s.playerVy,t.lastFlap=new Date,t.immunity&&(t.immunity=!1),s.debugMove&&(t.vx=-150)},d=function(t){t.vx=s.playerVx,t.vy=-s.playerVy,t.lastFlap=new Date,t.immunity&&(t.immunity=!1),s.debugMove&&(t.vx=150)},c=function(t,e,i){e.dashing=!0,e.lastDash=new Date,e.lastRing=new Date,e.canDash=!1,e.ring=!1,e.mass=Math.round(e.mass*s.dashMassLoss),u(t,e,i)},u=function(t,e,i){i.add(t),e.dashX=e.x,e.dashY=e.y,e.dashRange=a.getRingMax(e.mass),e.dashDone=0},p=function(t){for(var e=0;e<s.foodSpawnAmount;e++){var i=n.getInitFoodState(),a=t.getTile(i.x,i.y),r=a.getFoodController().add();r.setState(i)}},f=function(t){t.immunity&&new Date-t.startTime>s.playerImmunityTime&&(t.immunity=!1,t.vx=s.playerVx,t.vy=s.playerVy)},g=function(t,e){var i,s=Math.atan2(t.vy,t.vx);return t.dashing||(i=m(t,e)),t.dashing&&t.dashDone<t.dashRange&&(i=v(t,e,s)),t.dashing&&t.dashDone>=t.dashRange&&(i=y(t,s)),!!r(i.x,i.y)&&(t.x=i.x,t.y=i.y,!0)},m=function(t,e){return t.vy<s.playerVy&&new Date-t.lastFlap>100&&(t.vy+=s.playerGravity*e),t.vy>s.playerVy&&(t.vy=s.playerVy),s.debugMove&&(t.vy=0),{x:t.x+t.vx*e,y:t.y+t.vy*e}},v=function(t,e,i){return t.dashDone+=s.dashSpeed*e,{x:t.x+s.dashSpeed*Math.cos(i)*e,y:t.y+s.dashSpeed*Math.sin(i)*e}},y=function(t,e){return t.dashing=!1,{x:t.dashX+t.dashRange*Math.cos(e),y:t.dashY+t.dashRange*Math.sin(e)}},x=function(t,e,i,n){for(var r=e.length;r--;)for(var o=e[r],h=o.getFoodController(),l=h.getEntities(),d=l.length;d--;){var c=l[d],u=a.distEucl(c.state.x,c.state.y,t.x,t.y);u<i+s.foodHitbox&&(t.mass+=s.foodMass,h.remove(c,n.id))}},S=function(t,e,i,s,n){for(var a=i.getEntities(),r=a.length;r--;){var o=a[r];if(a[r].id!==-1&&o.id!=n)for(var h=o.getBallController().getEntities(),l=0;l<h.length;l++){var d=h[l];if(b(t,e,s,d))return!0}}},b=function(t,e,i,s){var n=a.distEucl(s.state.x,s.state.y,t.x,t.y),r=a.getBallRadius(s.state.mass);if(i+r>n){for(var o=0;o<20;o++);return!0}};e.getNewBallAngle=function(t,e){var i=(t+s.ballSpeed*e)%(2*Math.PI);return i},e.checkNewBalls=function(t){var e=t.getBallController(),i=e.getEntities(),n=t.state,a=n.mass;i.length||e.add(n),a>=s.ballTreshold&&1===i.length&&e.add(n),a>=2*s.ballTreshold&&2===i.length&&e.add(n)},e.getNewBallState=function(t,e,i,s){var a=(i+2*s*Math.PI/3)%(2*Math.PI),r=w(t.mass,s),o=n.getInitBallState(t,r,a);return o.active=e.active,o};var w=function(t,e){var i,n=s.ballTreshold,a=t-n,r=t-2*n,o=t-3*n,h=n+Math.round(o/3);return 0===e?i=t<n?t:t>=n&&t<3*n?n:h:1===e?i=t>=n&&t<2*n?a:t>=2*n&&t<3*n?n:h:2===e&&(i=t>=2*n&&t<3*n?r:h),i};e.getNewShootState=function(t,e){var i={},n=t.state;return i.x=n.x,i.y=n.y,i.mass=n.mass,i.lifeTime=n.lifeTime+e,i.ring=n.ring,!i.ring&&i.lifeTime>s.dashTime&&(i.ring=!0),!(i.lifeTime>s.dashTime+s.shootTime)&&i},e.getNewFoodState=function(t,e){var i={},n=t.state;if(i.xReal=n.xReal,i.yReal=n.yReal,i.angle=n.angle,i.vr=n.vr,i.movingTime=n.movingTime,void 0===t.referrer)i.angle=(n.angle+i.vr*s.foodRotationSpeed*e)%(2*Math.PI),i.x=n.xReal+s.foodRotationRadius*Math.cos(n.angle),i.y=n.yReal+s.foodRotationRadius*Math.sin(n.angle);else{var r=t.referrer.state;i.movingTime=n.movingTime+e;var o=r.x-n.x,h=r.y-n.y;if(i.x=n.x+o*i.movingTime/s.foodMovingTime,i.y=n.y+h*i.movingTime/s.foodMovingTime,a.distEucl(i.x,i.y,r.x,r.y)<s.foodEatenHitbox)return!1}return i},e.getInterpolatedEntityState=function(t,e,i){var s={};return s.x=t.x+i*(e.x-t.x),s.y=t.y+i*(e.y-t.y),s.vx=e.vx,e.vx/t.vx<0?s.vy=e.vy:s.vy=t.vy+i*(e.vy-t.vy),s.mass=Math.round(t.mass+i*(e.mass-t.mass)),s.ring=e.ring,s.dashing=e.dashing,s}},function(t,e,i){"use strict";var s=i(2),n=i(1);e.getInitPlayerState=function(){return{x:0,y:0,vx:0,vy:0,ring:!1,mass:n.playerInitMass,dashing:!1,startTime:new Date,lastRing:new Date,lastDash:new Date,canDash:!1,immunity:!0}},e.getInitSpectatorState=function(){return{x:0,y:0,mass:0}},e.getInitFoodState=function(){var t=s.getRandomPos(n.midLimitRad-50,n.midLimitRad+n.midLimitStroke+50,n.endLimitRad-50);return{x:t.x,y:t.y}},e.getInitBallState=function(t,e,i){var n=s.getRingRadius(t.mass),a=s.getBallPos(t.x,t.y,n,i);return{x:a.x,y:a.y,mass:e,angle:i,active:!0}}},function(t,e,i){"use strict";function s(){this.scale=1,this.scaleMass=1,this.zoom=0,this.scaleTarget=1,this.scaleCurrent=1}var n=i(1),a=i(2);e=t.exports=s,s.prototype={setScaleTarget:function(t){this.scaleTarget=this.scale*this.scaleMass*Math.pow(n.zoomFactor,this.zoom),t||(this.scaleCurrent=this.scaleTarget,this.resizeStage(this.scaleCurrent))},smoothResize:function(t){this.scaleTarget>this.scaleCurrent?(this.scaleCurrent+=.003*t,this.scaleCurrent>this.scaleTarget&&(this.scaleCurrent=this.scaleTarget),this.resizeStage(this.scaleCurrent)):this.scaleTarget<this.scaleCurrent&&(this.scaleCurrent-=.003*t,this.scaleCurrent<this.scaleTarget&&(this.scaleCurrent=this.scaleTarget),this.resizeStage(this.scaleCurrent))},zoomIn:function(t){for(var e=0;e<t;e++){var i=this.scale*this.scaleMass*Math.pow(n.zoomFactor,this.zoom+1);if(i>n.zoomScaleLimit)break;this.zoom+=1}this.setScaleTarget(!0)},zoomOut:function(t){for(var e=0;e<t;e++)this.zoom-=1,this.zoom<0&&!n.debugZoom&&(this.zoom=0);this.setScaleTarget(!0)},resizeCamera:function(){this.resizeCanvas(),this.resizeHud()},resizeCanvas:function(){var t=1.25*window.innerWidth,e=1.25*window.innerHeight;this.canvas.width=t,this.canvas.height=e,this.renderer.resize(this.canvas.width,this.canvas.height),this.stage.pivot.x=this.canvas.width/2,this.stage.pivot.y=this.canvas.height/2,this.stage.position.x=this.canvas.width/2,this.stage.position.y=this.canvas.height/2;var i=Math.max(t/n.scopeInitX,e/n.scopeInitY),s=a.round(2,i*n.scopeInitX),r=a.round(2,i*n.scopeInitY);s>t?this.scale=window.innerHeight/n.scopeInitY:r>e&&(this.scale=window.innerWidth/n.scopeInitX),this.setScaleTarget(!1)},resizeMass:function(t){this.scaleMass=a.getScaleMass(t),this.setScaleTarget(!1)},resizeStage:function(t){this.stage.scale.set(t)},resizeHud:function(){this.leaderboard.style.fontSize=this.board.offsetWidth/7+"px",this.entry.style.fontSize=this.board.offsetWidth/11+"px";var t=5*this.scale,e=5*this.scale,i=5*this.scale,s=this.canvas.height-25*this.scale,a=5*this.scale,r=30*this.scale,o=5*this.scale,h=50*this.scale,l=this.canvas.width-60*this.scale,d=this.canvas.height-60*this.scale;this.fpsText.position.set(t,e),this.score.position.set(i,s),this.x.position.set(a,r),this.y.position.set(o,h);var c=this.getStyle(20);this.fpsText.style=c,this.score.style=c,this.x.style=c,this.y.style=c,this.minimap.clear(),this.minimap.beginFill(11053224,.5),this.minimap.drawCircle(l,d,n.minimapRad*this.scale)}}},function(t,e,i){"use strict";function s(){this.canvas=document.getElementById("ctx"),this.preload(),window.addEventListener("resize",function(t){this.resizeCamera()}.bind(this)),this.resizeCamera(),this.assetsLoaded=!1}var n=i(1),a=i(2),r=i(11),o=i(8),h=i(10);e=t.exports=s;var l=_.extend(Object.create(o.prototype),Object.create(r.prototype),Object.create(h.prototype));s.prototype=_.extend(l,{preload:function(){this.renderer=new PIXI.autoDetectRenderer(n.scopeInitX,n.scopeInitY,{view:this.canvas}),this.renderer.clearBeforeRender=!1,this.preloadTextures(),this.preloadStage(),o.call(this),this.preloadHud()},preloadStage:function(){this.stage=new PIXI.Container,this.stage.displayList=new PIXI.DisplayList,this.limitLayer=new PIXI.DisplayGroup(0,!1),this.tunnelLayer=new PIXI.DisplayGroup(1,!1),this.foodLayer=new PIXI.DisplayGroup(2,!1),this.playerLayer=new PIXI.DisplayGroup(3,!1)},onTexturesLoaded:function(){this.preloadSprites(),this.drawMap({x:0,y:0}),this.assetsLoaded=!0,signPanelDiv.style.display="block",this.canvas.style.display="block"},preloadSprites:function(){this.map=new PIXI.extras.TilingSprite(this.mapTxt,n.mapSize,n.mapSize),this.map.displayGroup=this.limitLayer,this.stage.addChild(this.map),this.midLimit=new PIXI.Sprite(this.midLimitTxt),this.midLimit.displayGroup=this.limitLayer,this.stage.addChild(this.midLimit),this.endLimit=new PIXI.Sprite(this.endLimitTxt),this.endLimit.displayGroup=this.limitLayer,this.stage.addChild(this.endLimit),this.tunnel=new PIXI.Graphics,this.tunnel.displayGroup=this.tunnelLayer,this.stage.addChild(this.tunnel),this.debug=new PIXI.Graphics,this.debug.displayGroup=this.tunnelLayer,this.stage.addChild(this.debug)},render:function(){this.renderer.render(this.stage),this.renderer.render(this.hud)},drawBoard:function(t){for(var e=t.length,i=0;i<e;i++)this.entries[i].textContent=i+1+". "+t[i];if(e<10)for(var i=e;i<10;i++)this.entries[i].textContent=""},drawMap:function(t){var e=this.canvas.width/2-t.x,i=this.canvas.height/2-t.y;this.map.anchor.set(.5),this.map.position.set(e,i),this.map.alpha=1;var s=Math.atan2(t.y,t.x);this.midLimit.position.x=e+n.midLimitOffset*Math.sqrt(2)*Math.cos(s),this.midLimit.position.y=i+n.midLimitOffset*Math.sqrt(2)*Math.sin(s),this.midLimit.rotation=-Math.PI/4+s,this.endLimit.position.x=e+n.endLimitOffset*Math.sqrt(2)*Math.cos(s),this.endLimit.position.y=i+n.endLimitOffset*Math.sqrt(2)*Math.sin(s),this.endLimit.rotation=-Math.PI/4+s,this.tunnel.clear(),this.tunnel.beginFill(65280,.5),t.x<0?this.tunnel.drawRect(e-(n.midLimitRad+n.midLimitStroke),i-n.tunnelHeight/2,n.midLimitStroke,n.tunnelHeight):this.tunnel.drawRect(e+n.midLimitRad,i-n.tunnelHeight/2,n.midLimitStroke,n.tunnelHeight);var a=this.canvas.width+(t.x*n.minimapRad/n.midLimitRad-60)*this.scale,r=this.canvas.height+(t.y*n.minimapRad/n.midLimitRad-60)*this.scale;if(this.miniself.clear(),this.miniself.beginFill(0,.5),this.miniself.drawCircle(a,r,n.miniselfRad*this.scale),this.debug.clear(),n.debugTileSize){this.debug.lineStyle(3,16711680);var o=Math.floor(n.endLimitRad/n.tileAmountX),h=Math.floor(n.endLimitRad/n.tileAmountY);this.debug.drawRect(e,i,o,h)}},drawPlayer:function(t,e){var i=a.getPlayerSize(t.state.mass);t.sprite||(t.sprite=new PIXI.extras.MovieClip(this.playerTxtList),t.sprite.animationSpeed=.15,t.sprite.play(),t.sprite.anchor.set(.5),t.sprite.displayGroup=this.playerLayer,this.stage.addChild(t.sprite),t.spriteDash=new PIXI.extras.MovieClip(this.dashTxtList),t.spriteDash.animationSpeed=.3,t.spriteDash.anchor.set(.5),t.spriteDash.blendMode=PIXI.BLEND_MODES.ADD,t.spriteDash.visible=!1,t.spriteDash.displayGroup=this.foodLayer,this.stage.addChild(t.spriteDash),t.spriteRing=new PIXI.Sprite(this.ringTxt),t.spriteRing.anchor.set(.5),t.spriteRing.alpha=0,t.spriteRing.displayGroup=this.playerLayer,this.stage.addChild(t.spriteRing),t.graphics=new PIXI.Graphics,this.stage.addChild(t.graphics),t.text=new PIXI.Text(t.name,this.textOpt),t.text.anchor.set(.5),this.hud.addChild(t.text));var s=t.state.x-e.x+this.canvas.width/2,r=t.state.y-e.y+this.canvas.height/2;t.text.position.x=s,t.text.position.y=r+i-15,t.text.style=this.getStyle(14);var o=Math.atan2(t.state.vy,t.state.vx);if(t.state.vx<0?(t.sprite.scale.x=-1,t.sprite.rotation=o+Math.PI):(t.sprite.scale.x=1,t.sprite.rotation=o),t.state.dashing||0!==t.sprite.currentFrame||t.state.vy!==n.playerVy?t.sprite.playing||t.sprite.play():t.sprite.stop(),t.state.dashing?(t.sprite.animationSpeed=.3,t.sprite.alpha>.8&&(t.sprite.alpha-=.05),t.spriteDash.play(),t.spriteDash.visible=!0):t.spriteDash.playing&&(t.sprite.animationSpeed=.15,t.sprite.alpha=1,t.spriteDash.gotoAndStop(0),t.spriteDash.visible=!1),t.sprite.position.x=s,t.sprite.position.y=r,t.sprite.width=i,t.sprite.height=i,t.spriteDash.position.x=s,t.spriteDash.position.y=r,t.spriteDash.width=i,t.spriteDash.height=i,i=a.getRingSize(t.state.mass),t.spriteRing.position.x=s,t.spriteRing.position.y=r,t.spriteRing.width=i,t.spriteRing.height=i,t.state.ring?t.spriteRing.alpha<1&&(t.spriteRing.alpha+=.1,t.spriteRing.alpha=Math.round(10*t.spriteRing.alpha)/10):t.spriteRing.alpha>0&&(t.spriteRing.alpha=0),t.spriteRing.visible=!1,this.debug.lineStyle(2,16711680),n.debugSelfHitbox){var h=a.getSelfScope(t.state.mass);this.debug.drawCircle(s,r,h)}if(n.debugSelfScope){var l=Math.floor(n.tileScopeAmountX*n.endLimitRad/n.tileAmountX),d=Math.floor(n.tileScopeAmountY*n.endLimitRad/n.tileAmountY);this.debug.drawRect(s-l/4,r-d/4,l/2,d/2)}n.debugRingHitbox&&(this.debug.drawCircle(s,r,a.getRingMin(t.state.mass)),this.debug.drawCircle(s,r,a.getRingMax(t.state.mass)))},drawBall:function(t,e){t.sprite||(t.sprite=new PIXI.extras.MovieClip(this.fireballTxtList),t.sprite.animationSpeed=.2,t.sprite.play(),t.sprite.anchor.set(.5),t.sprite.displayGroup=this.playerLayer,this.stage.addChild(t.sprite));var i=a.getBallSize(t.state.mass);t.sprite.width=i,t.sprite.height=i;var s=t.state.x-e.x+this.canvas.width/2,n=t.state.y-e.y+this.canvas.height/2;t.sprite.position.set(s,n),t.sprite.rotation=t.state.angle+Math.PI/2,this.debug.beginFill(16711680),this.debug.beginFill(16711680,0)},drawFood:function(t,e){if(!t.sprite){var i=Math.round(Math.random()*(n.foodPaletteSize-1));t.sprite=new PIXI.Sprite(this.foodTxtList[i]),t.sprite.blendMode=PIXI.BLEND_MODES.ADD,t.sprite.anchor.set(.5),t.sprite.alpha=0,t.sprite.displayGroup=this.foodLayer,this.stage.addChild(t.sprite)}var s=t.state.x-e.x+this.canvas.width/2,r=t.state.y-e.y+this.canvas.height/2;if(t.sprite.position.x=s,t.sprite.position.y=r,t.referrer){var o=t.referrer.state,h=a.distEucl(o.x,o.y,t.state.x,t.state.y),l=1-(n.foodHitbox-n.foodEatenHitbox)/(2*h);l<0&&(l=0),t.sprite.scale.set(l)}t.sprite.alpha<1&&(t.sprite.alpha+=.05,t.sprite.alpha=Math.round(100*t.sprite.alpha)/100,t.sprite.scale.set(t.sprite.alpha)),n.debugFoodHitbox&&(this.debug.lineStyle(1,16711680),this.debug.drawCircle(t.state.xReal-e.x+this.canvas.width/2,t.state.yReal-e.y+this.canvas.height/2,n.foodHitbox))},drawShoot:function(t,e){t.sprite||(t.sprite=new PIXI.Sprite(this.ringTxt),t.sprite.anchor.set(.5),t.sprite.displayGroup=this.playerLayer,this.stage.addChild(t.sprite));var i=a.getRingSize(t.state.mass),s=t.state.lifeTime/n.dashTime;s>1&&(s=1),t.sprite.width=s*i,t.sprite.height=s*i,t.sprite.position.x=t.state.x-e.x+this.canvas.width/2,t.sprite.position.y=t.state.y-e.y+this.canvas.height/2},removeSprites:function(t,e,i){for(var s=t.length;s--;){var n=t[s].getBallController().getEntities();t[s].sprite&&(this.stage.removeChild(t[s].sprite),t[s].sprite.destroy());for(var a=n.length;a--;)n[a].sprite&&(this.stage.removeChild(n[a].sprite),n[a].sprite.destroy());t[s].spriteRing&&(this.stage.removeChild(t[s].spriteRing),t[s].spriteRing.destroy()),t[s].spriteDash&&(this.stage.removeChild(t[s].spriteDash),t[s].spriteDash.destroy()),t[s].graphics&&(this.stage.removeChild(t[s].graphics),t[s].graphics.destroy(!0)),t[s].text&&(this.hud.removeChild(t[s].text),t[s].text.destroy(!0))}for(var s=e.length;s--;)e[s].sprite&&(this.stage.removeChild(e[s].sprite),e[s].sprite.destroy());for(var s=i.length;s--;)i[s].sprite&&(this.stage.removeChild(i[s].sprite),i[s].sprite.destroy())},getStyle:function(t){return{fontFamily:"raleway",fill:"#ffffff",stroke:"#000000",fontSize:Math.floor(t*this.scale)+"px",strokeThickness:2*this.scale}}})},function(t,e,i){"use strict";function s(){}var n=i(38);e=t.exports=s,s.prototype={preloadHud:function(){this.hud=new PIXI.Container,this.board=document.getElementById("boardDiv"),this.leaderboard=document.getElementById("leaderboard"),this.entry=document.getElementById("entry");var t=["one","two","three","four","five","six","seven","eight","nine","ten"];this.entries=[];for(var e=0;e<10;e++)this.entries.push(document.getElementById(t[e]));this.textOpt={fontFamily:"raleway",fill:"#ffffff",stroke:"#000000"},this.fps=new n,this.fpsText=new PIXI.Text("",this.textOpt),this.hud.addChild(this.fpsText),setInterval(function(){this.fpsText.text="Fps: "+this.fps.getFps()}.bind(this),1e3),this.score=new PIXI.Text("",this.textOpt),this.hud.addChild(this.score),this.x=new PIXI.Text("",this.textOpt),this.hud.addChild(this.x),this.y=new PIXI.Text("",this.textOpt),this.hud.addChild(this.y),this.minimap=new PIXI.Graphics,this.hud.addChild(this.minimap),this.miniself=new PIXI.Graphics,this.hud.addChild(this.miniself),this.hud.visible=!1},drawHud:function(t){this.score.text!="Mass : "+t.mass&&(this.score.text="Mass : "+t.mass),this.x.text="x: "+Math.round(t.x),this.y.text="y: "+Math.round(t.y)}}},function(t,e,i){"use strict";function s(){}var n=i(1);e=t.exports=s,s.prototype={preloadTextures:function(){this.loader=new PIXI.loaders.Loader,this.loader.add("ringTxt",n.ringImg).add("mapTxt",n.mapImg).add(n.playerSet).add(n.fireballSet).on("progress",this.onAssetsLoading.bind(this)).once("complete",this.onAssetsLoaded.bind(this)).load();var t=this.createBorderTexture(n.midLimitRad,n.midLimitStroke,n.midLimitOffset);this.midLimitTxt=new PIXI.Texture.fromCanvas(t);var e=this.createBorderTexture(n.endLimitRad,n.endLimitStroke,n.endLimitOffset);this.endLimitTxt=new PIXI.Texture.fromCanvas(e),this.foodTxtList=[];for(var i=0;i<n.foodPaletteSize;i++){var s=this.createFoodTexture(i,10);this.foodTxtList.push(new PIXI.Texture.fromCanvas(s))}this.dashTxtList=[];for(var i=0;i<n.dashTxtSize;i++){var a={x:25,y:25,rad:25,r:n.foodColor2[0],g:n.foodColor2[1],b:n.foodColor2[2]},r=this.createDashTexture(i,a);this.dashTxtList.push(new PIXI.Texture.fromCanvas(r))}var o=this.dashTxtList.slice(1,-1);this.dashTxtList=this.dashTxtList.concat(o.reverse())},onAssetsLoading:function(t,e){console.log("Progress:",t.progress+"%")},onAssetsLoaded:function(){var t=this.loader.resources;this.ringTxt=t.ringTxt.texture,this.mapTxt=t.mapTxt.texture,this.playerTxtList=[];for(var e=0;e<3;e++)this.playerTxtList.push(PIXI.Texture.fromFrame("flappy"+e+".png"));this.fireballTxtList=[];for(var e=0;e<6;e++)this.fireballTxtList.push(PIXI.Texture.fromFrame("fireball"+e+".png"));this.onTexturesLoaded()},createBorderTexture:function(t,e,i){var s=t+e-i,a=this.createCanvas(s,s),r=a.getContext("2d");return n.debugBorder&&(r.strokeStyle="rgba(250, 255, 0, 0.7)",r.lineWidth=5,r.strokeRect(0,0,s,s)),r.beginPath(),r.arc(-i,-i,t+e/2,0,Math.PI/2),r.lineWidth=e,r.strokeStyle="rgba(255, 0, 0, 0.7)",r.stroke(),a},createFoodTexture:function(t,e){var i=20+3*e,s=this.createCanvas(i,i),a=s.getContext("2d");a.globalCompositeOperation="lighter",n.debugFood&&(a.strokeStyle="rgba(250, 255, 0, 0.7)",a.lineWidth=5,a.strokeRect(0,0,i,i)),a.beginPath();var r={x:i/2,y:i/2,rad:i/2,r:n["foodColor"+t][0],g:n["foodColor"+t][1],b:n["foodColor"+t][2]},o=a.createRadialGradient(r.x,r.y,0,r.x,r.y,r.rad),h="rgba("+r.r+","+r.g+","+r.b+",0.65)",l="rgba("+r.r+","+r.g+","+r.b+",0.0)";return o.addColorStop(0,l),o.addColorStop(.2,l),o.addColorStop(.6,h),o.addColorStop(.95,l),a.fillStyle=o,a.arc(r.x,r.y,r.rad,0,2*Math.PI,!1),a.fill(),a.fillStyle="rgba("+r.r+","+r.g+","+r.b+",0.4)",a.beginPath(),a.arc(r.x,r.y,r.rad-4-e/2,0,2*Math.PI,!1),a.strokeStyle="rgba("+r.r+","+r.g+","+r.b+",0.8)",a.lineWidth=2,a.stroke(),s},createDashTexture:function(t,e){var i=this.createCanvas(2*e.rad,2*e.rad),s=i.getContext("2d");s.globalCompositeOperation="lighter",s.beginPath();var n=s.createRadialGradient(e.x,e.y,0,e.x,e.y,e.rad),a="rgba("+e.r+","+e.g+","+e.b+",0.6)",r="rgba("+e.r+","+e.g+","+e.b+",0.0)";n.addColorStop(0,a),n.addColorStop(.7+.05*t,r),s.fillStyle=n,s.arc(e.x,e.y,e.rad,0,2*Math.PI,!1);for(var o=-3;o<t;o++)s.fill();return i},createCanvas:function(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i}}},function(t,e,i){"use strict";function s(t){a.debug&&new n(t),this.socket=t,this.stateController=new h,this.selfId=-1,this.inTransition=!1,o.call(this),r.call(this)}var n=(i(23),i(22)),a=i(1),r=i(29),o=i(28),h=i(21);e=t.exports=s,s.prototype=_.extend(Object.create(r.prototype),Object.create(o.prototype),{onDisconnect:function(){this.stateController.clearEntities(),this.socket.close(),console.log("Disconnected")},setInTransition:function(t){this.inTransition=t},getStateController:function(){return this.stateController},getSelfId:function(){return this.selfId},isInTransition:function(){return this.inTransition}})},function(t,e,i){"use strict";function s(t,e,i){n.call(this),this.nextId=1,this.referrerId=t,this.ballAngle=e,this.ballLastTime=i}var n=i(4),a=i(14);e=t.exports=s,s.prototype=_.extend(Object.create(n.prototype),{add:function(t){var e=new a(this.nextId++,this.referrerId,t);return this.entities.push(e),e},getBallAngle:function(){return this.ballAngle},getBallLastTime:function(){return this.ballLastTime},setBallAngle:function(t){this.ballAngle=t},setBallLastTime:function(t){this.ballLastTime=t}})},function(t,e,i){"use strict";function s(t,e,i){n.call(this,t),this.referrerId=e,this.state=a.getInitBallState(i,0,0)}var n=i(3),a=i(7);e=t.exports=s,s.prototype=_.extend(Object.create(n.prototype),{})},function(t,e,i){"use strict";function s(t){n.call(this,t),this.state.movingTime=0}var n=i(3);e=t.exports=s,s.prototype=Object.create(n.prototype)},function(t,e,i){"use strict";function s(t,e,i,s){n.call(this,t),this.name=e,this.ballController=new a(t,i,s)}var n=i(3),a=i(13),r=i(5),o=i(1);e=t.exports=s,s.prototype=_.extend(Object.create(n.prototype),{addUpdate:function(t,e){var i=t;if(0===this.updates.length)this.state=t;else{var s=this.updates[this.updates.length-1].state;void 0===t.x&&(i.x=s.x),void 0===t.y&&(i.y=s.y),void 0===t.vx&&(i.vx=s.vx),void 0===t.vy&&(i.vy=s.vy),void 0===t.ring&&(i.ring=s.ring),void 0===t.mass&&(i.mass=s.mass),void 0===t.dashing&&(i.dashing=s.dashing)}var n=new r(i,e);this.updates.push(n),this.updates.length>o.clientMaxUpdateBuffer&&this.updates.splice(0,1)},getBallController:function(){return this.ballController}})},function(t,e,i){"use strict";function s(t){n.call(this,t)}var n=i(3);e=t.exports=s,s.prototype=Object.create(n.prototype)},function(t,e,i){"use strict";function s(){n.call(this)}var n=i(4),a=i(15);e=t.exports=s,s.prototype=_.extend(n.prototype,{add:function(t){var e=new a(t);return this.entities.push(e),e}})},function(t,e,i){"use strict";function s(){n.call(this),this.board=[],this.updatedBoard=!1}var n=i(4),a=i(16);e=t.exports=s,s.prototype=_.extend(Object.create(n.prototype),{add:function(t,e,i,s){var n=new a(t,e,i,s);return this.entities.push(n),n},setBoard:function(t){this.board=t},setUpdatedBoard:function(t){this.updatedBoard=t},getBoard:function(){return this.board},isUpdatedBoard:function(){return this.updatedBoard}})},function(t,e,i){"use strict";function s(){n.call(this)}var n=i(4),a=i(17);e=t.exports=s,s.prototype=Object.create(n.prototype),s.prototype.add=function(t){var e=new a(t);return this.entities.push(e),e}},function(t,e,i){"use strict";function s(){this.serverTime=0,this.interpolationTime=n.clientInterpolationTime,this.rendered=0,this.lastRenderTime=0,this.rendering=!1,this.smoothingFactor=n.clientSmoothingFactor,this.playerController=new o,this.foodController=new h,this.shootController=new l,n.debug&&(this.debug=new Debug),this.lagCompensation=n.serverLagCompensation}var n=i(1),a=i(2),r=i(6),o=(i(5),i(19)),h=i(18),l=i(20);e=t.exports=s,s.prototype={clearEntities:function(){console.log("removing"),this.playerController.clearEntities(),this.foodController.clearEntities(),this.shootController.clearEntities()},updatePlayerStates:function(){for(var t=this.playerController.getEntities(),e=t.length;e--;){var i=t[e];i.getUpdates().length&&this.updatePlayerState(i)}},updatePlayerState:function(t){var e=new Date,i=0;this.rendering&&(i=this.rendered+(e-this.lastRenderTime)),this.rendered=i,this.lastRenderTime=e;var s,n,a,o=this.getRenderTime(i),s=t.getInterpolatedUpdates(o);!s.previous&&t.isVisible()&&console.log("Jittering"),s.previous&&s.target?(n=this.getInterpolatedValue(s.previous.time,s.target.time,o),a=r.getInterpolatedEntityState(s.previous.state,s.target.state,n),t.setState(a),this.predictBallStates(t,o),this.rendering=!0):t.isToRemove()&&this.playerController.removeEntity(t)},getInterpolatedValue:function(t,e,i){var s=e-t,n=i-t,a=n/s;a>1&&(a=1);var r=parseFloat(a.toFixed(3));return r},getRenderTime:function(t){var e=this.serverTime-this.interpolationTime+t;return e},setServerTime:function(t){this.serverTime=t},setElapsedLastUpdate:function(t){this.serverTime&&(this.elapsedLastUpdate+=t)},predictBallStates:function(t,e){var i=t.getBallController(),s=(e-i.getBallLastTime())/1e3;i.setBallLastTime(e);var n=i.getBallAngle(),a=r.getNewBallAngle(n,s);i.setBallAngle(a),r.checkNewBalls(t);for(var o=i.getEntities(),h=0;h<o.length;h++){var l=o[h],d=r.getNewBallState(t.state,l.state,a,h);l.setState(d)}},predictShootStates:function(t){for(var e=this.shootController.getEntities(),i=e.length;i--;){var s=e[i],n=r.getNewShootState(s,t);n?s.setState(n):this.shootController.removeEntity(s)}},predictFoodStates:function(t){for(var e=this.foodController.getEntities(),i=e.length;i--;){var s=e[i],n=r.getNewFoodState(s,t);n?s.setState(n):this.foodController.removeEntity(s)}},addPlayerUpdates:function(t,e){for(var i=e.length;i--;){var s,n=e[i],r=n[0],o=n[1],h=a.idxOf(this.playerController.getEntities(),"id",r);if(h>=0)s=this.playerController.getEntities()[h];else{var l=n[2],d=n[3];s=this.playerController.add(r,l,d,t)}s.addUpdate(o,t)}this.playerController.getEntities()},updateShootStates:function(t){this.initStates(t,this.shootController)},updateFoodInitStates:function(t){this.initStates(t,this.foodController)},initStates:function(t,e){for(var i=t.length;i--;){var s=t[i],n=e.add(s[0]);n.setState(s[1])}},updatePlayerRemoveStates:function(t){this.updateEntityRemoveStates(t,this.playerController)},updateFoodRemoveStates:function(t){this.updateEntityRemoveStates(t,this.foodController)},updateEntityRemoveStates:function(t,e){for(var i=this,s=t.length;s--;)!function(){var n=t[s];setTimeout(function(){var t=e.getEntities(),i=a.idxOf(t,"id",n);i>=0&&e.remove(i)},i.interpolationTime)}()},updateFoodEatStates:function(t){for(var e=this,i=t.length;i--;)!function(){var s=t[i][0],n=t[i][1];setTimeout(function(){var t=e.foodController.getEntities(),i=a.idxOf(t,"id",s);if(i>=0){var r=t[i],o=e.playerController.getEntities(),h=a.idxOf(o,"id",n);if(h>=0){var l=o[h];r.referrer=l}}},e.interpolationTime)}()},updateBoard:function(t){t.length&&(this.playerController.setBoard(t),this.playerController.setUpdatedBoard(!0))},getPlayerController:function(){return this.playerController},getFoodController:function(){return this.foodController},getShootController:function(){return this.shootController}}},function(t,e){"use strict";function i(t){var e=document.getElementById("chat-text"),i=document.getElementById("chat-input"),s=document.getElementById("chat-form");t.on("addToChat",function(t){e.innerHTML+="<div>"+t+"</div>"}),t.on("evalAnswer",function(t){console.log(t)}),
s.onsubmit=function(e){e.preventDefault(),"/"===i.value[0]?t.emit("evalServer",i.value.slice(1)):t.emit("sendMsgToServer",i.value),i.value=""}}e=t.exports=i},function(t,e){"use strict";function i(){debugDiv.style.display="inline-block",this.serverPhysicsInterval=null,this.serverStateInterval=null,this.lagCompensation=null,this.interpolation=null,this.interpolationTime=null;var t=(document.getElementById("player_status"),document.getElementById("lag")),e=document.getElementById("serverPhysicsInterval"),i=document.getElementById("serverStateInterval"),s=document.getElementById("interpolation"),n=document.getElementById("interpolationTime");e.value=cfg.serverPhysicsInterval,i.value=cfg.serverStateInterval,t.value=cfg.serverLagCompensation,s.checked=cfg.interpolation,n.value=cfg.interpolationTime;var a=function(){this.lagCompensation=r(this.lagCompensation,t),this.serverPhysicsInterval=r(this.serverPhysicsInterval,e),this.serverStateInterval=r(this.serverStateInterval,i),this.interpolation=s.checked,this.interpolationTime=r(this.interpolationTime,n)}.bind(this),r=function(t,e){var i=parseInt(e.value);return isNaN(i)&&(i=t),e.value=i,i};t.onchange=a,e.onchange=a,i.onchange=a,s.onchange=a,n.onchange=a,a()}e=t.exports=i},function(t,e){"use strict";function i(){}t.exports=i,i.prototype.form=function(){var t=new ArrayBuffer(1),e=new DataView(t);return e.setUint8(0,2),t}},function(t,e){"use strict";function i(t){this.input=t}t.exports=i,i.prototype.form=function(){var t=new ArrayBuffer(1),e=new DataView(t);return e.setUint8(0,this.input),t}},function(t,e,i){"use strict";function s(t){this.name=t}var n=i(35);t.exports=s,s.prototype.form=function(){var t=new n;return t.setUint8(1),t.setStringUTF8(this.name),t.form()}},function(t,e,i){"use strict";t.exports={Submit:i(26),Clear:i(24),Input:i(25)}},function(t,e,i){"use strict";function s(){this.seqUpdates=0,this.handler={1:this.onMsgSubmit.bind(this),2:this.onMsgClear.bind(this),10:this.onMsgUpdate.bind(this)},this.handleSocketEvents()}var n=i(34);i(1);e=t.exports=s,s.prototype={handleSocketEvents:function(){this.socket.onmessage=function(t){var e=t.data;this.handleMessage(e)}.bind(this),this.socket.onclose=function(){this.onDisconnect()}.bind(this),this.socket.onerror=function(t){console.log("ERROR "+t.data)}},handleMessage:function(t){if(0!==t.byteLength){var e=new DataView(t),i=e.getUint8(0);this.handler.hasOwnProperty(i)&&this.handler[i](t)}},onMsgClear:function(t){this.stateController.clearEntities(),this.selfId!==-1&&(this.selfId=-1,this.inTransition=!0)},onMsgSubmit:function(t){var e=new n(t);e.addOffset(1);var i=e.getUint16();console.log(i),this.selfId=i,this.inTransition=!0},onMsgUpdate:function(t){var e=new n(t);e.addOffset(1);var i=e.getUint32();console.log("receiv"),this.stateController.rendering&&(this.stateController.rendered-=i-this.stateController.serverTime),this.stateController.setServerTime(i);var s=e.getFlags(),a=s[0],r=s[1],o=s[2],h=s[3],l=s[4],d=s[5],c=s[6];if(a){for(var u=e.getUint8(),p=[],f=0;f<u;f++){var g,m,v=e.getUint16(),y={},x=e.getFlags(),S=x[0],b=x[1],w=x[2],I=x[3],C=x[4],T=x[5];y.ring=x[6],y.dashing=x[7];var M=e.getFlags(),R=M[0];if(S&&(g=e.getStringUTF8()),b&&(y.x=e.getFloat32()),w&&(y.y=e.getFloat32()),I){var L=e.getInt16();y.vx=L/100}if(C){var F=e.getInt16();y.vy=F/100}T&&(y.mass=e.getUint32()),R&&(m=e.getFloat32(),console.log("angle "+m)),S?(console.log(v),p.push([v,y,g,m])):p.push([v,y])}this.stateController.addPlayerUpdates(i,p)}if(r){for(var k=e.getUint16(),E=[],f=0;f<k;f++){var v=e.getUint16();E.push(v)}this.stateController.updatePlayerRemoveStates(E)}if(o){for(var B=e.getUint8(),D=[],f=0;f<B;f++){var y={};y.x=e.getFloat32(),y.y=e.getFloat32(),y.mass=e.getUint16(),y.lifeTime=e.getUint16(),D.push([null,y])}this.stateController.updateShootStates(D)}if(h){for(var P=e.getUint16(),U=[],f=0;f<P;f++){var v=e.getUint16(),y={movingTime:0,angle:0,vr:Math.random()};y.xReal=e.getFloat32(),y.yReal=e.getFloat32(),y.x=y.xReal,y.y=y.yReal,U.push([v,y])}this.stateController.updateFoodInitStates(U)}if(l){for(var z=e.getUint16(),O=[],f=0;f<z;f++){var v=e.getUint16();O.push(v)}this.stateController.updateFoodRemoveStates(O)}if(d){for(var X=e.getUint8(),A=[],f=0;f<X;f++){var v=e.getUint16(),V=e.getUint16();A.push([v,V])}this.stateController.updateFoodEatStates(A)}if(c){for(var H=e.getUint8(),G=[],f=0;f<H;f++){var g=e.getStringUTF8();G.push(g)}this.stateController.updateBoard(G)}}}},function(t,e,i){"use strict";function s(){this.onSubmit()}var n=i(27);e=t.exports=s,s.prototype={sendMessage:function(t){if(1===this.socket.readyState){var e=t.form();this.socket.send(e)}else this.onDisconnect()},onSubmit:function(){var t=document.getElementById("sign-form"),e=document.getElementById("signDiv-username");t.onsubmit=function(t){t.preventDefault(),this.sendMessage(new n.Submit(e.value))}.bind(this)},onSubmitted:function(){this.sendMessage(new n.SubmitACK)},onInput:function(t){this.sendMessage(new n.Input(t))}}},function(t,e,i){"use strict";function s(){this.gameloop=new a,this.canvas=new r,this.keyboard=new o,this.mouse=new h(this.canvas.canvas);var t=location.origin.replace(/^http/,"ws"),e=new WebSocket(t);e.binaryType="arraybuffer",e.onopen=function(t){this.client=new n(e),this.startGame()}.bind(this)}var n=i(12),a=(i(6),i(31)),r=i(9),o=i(32),h=i(33),l=i(1);s.prototype={startGame:function(){var t=this.client.getSelfId(),e=0,i=null,s=0;this.gameloop.start(function(){var e=this.client.getStateController(),n=new Date;i=i||n,s=n-i,i=n,e.updatePlayerStates(),e.predictShootStates(s),e.predictFoodStates(s),this.client.isInTransition()&&(t===-1?t=this.updateNewGame():(console.log("ooooh"),t=this.updateGameOver())),t!==-1&&this.processInputs()}.bind(this),function(){if(this.canvas.assetsLoaded){t!=-1&&this.canvas.smoothResize(s);var i=this.client.getStateController(),n=i.getPlayerController(),a=i.getFoodController(),r=i.getShootController();this.removeRemovedEntitiesSprites(n,a,r);var o=n.getEntities(),h=a.getEntities(),l=r.getEntities(),d=n.getEntityState(t);if(void 0!==d.mass){d.mass!==e&&(e=d.mass,this.canvas.resizeMass(e)),this.canvas.drawMap(d);for(var c=h.length;c--;){var u=h[c];u.isVisible()&&this.canvas.drawFood(u,d)}for(var c=l.length;c--;){var p=l[c];p.isVisible()&&this.canvas.drawShoot(p,d)}for(var c=o.length;c--;){var f=o[c];if(f.isVisible()){this.canvas.drawPlayer(f,d);for(var g=f.getBallController().getEntities(),m=g.length;m--;){var v=g[m];this.canvas.drawBall(v,d)}}}this.canvas.drawHud(d),n.isUpdatedBoard()&&(this.canvas.drawBoard(n.getBoard()),n.setUpdatedBoard(!1)),this.canvas.render()}this.canvas.fps.setFps(new Date)}}.bind(this))},processInputs:function(){this.processKeyboard(),this.processMouse()},processKeyboard:function(){var t=this.keyboard.pressed("leftEU"),e=this.keyboard.pressed("leftUS"),i=t||e,s=this.keyboard.pressed("right"),n=this.keyboard.pressed("space");i&&this.keyboard.keyUp.left&&(this.client.onInput(10),this.keyboard.keyUp.left=!1),s&&this.keyboard.keyUp.right&&(this.client.onInput(11),this.keyboard.keyUp.right=!1),n&&this.keyboard.keyUp.space&&(this.client.onInput(12),this.keyboard.keyUp.space=!1),i||(this.keyboard.keyUp.left=!0),s||(this.keyboard.keyUp.right=!0),n||(this.keyboard.keyUp.space=!0),l.debugMove&&(this.keyboard.keyUp.left=!0,this.keyboard.keyUp.right=!0)},processMouse:function(){this.mouse.click&&(this.client.onInput(13),this.mouse.click=!1);var t=this.mouse.wheeled();t>0?this.canvas.zoomIn(t):t<0&&this.canvas.zoomOut(-t)},updateNewGame:function(){return signPanelDiv.style.display="none",hudDiv.style.visibility="visible",this.canvas.hud.visible=!0,this.mouse.running=!0,this.client.setInTransition(!1),this.client.getSelfId()},updateGameOver:function(){return signPanelDiv.style.display="block",hudDiv.style.visibility="hidden",this.canvas.hud.visible=!1,this.mouse.running=!1,this.client.setInTransition(!1),-1},removeRemovedEntitiesSprites:function(t,e,i){this.canvas.removeSprites(t.getRemovedEntities(),e.getRemovedEntities(),i.getRemovedEntities()),t.clearRemovedEntities(),i.clearRemovedEntities(),e.clearRemovedEntities()}};var d=document.getElementById("sign-form");d.onsubmit=function(t){return t.preventDefault(),!1};new s},function(t,e){"use strict";function i(){this.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),this.now=new Date,this.accum=0}e=t.exports=i,i.prototype.start=function(t,e){function i(){s.requestAnimFrame.call(window,i);var n=new Date,a=n-s.now;for(a>250&&(a=250),s.now=n,s.accum+=a;s.accum>=15;)t(),s.accum-=15;e()}var s=this;i()}},function(t,e){"use strict";function i(){this.keyCodes={},this.keyUp={left:!0,up:!0,right:!0,down:!0,space:!0},this.alias={leftEU:65,leftUS:81,up:90,right:68,down:83,space:32,pageup:33,pagedown:34,tab:9},this.onKeyDown=function(t){this.onKeyChange(t,!0)}.bind(this),this.onKeyUp=function(t){this.onKeyChange(t,!1)}.bind(this),document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.onKeyUp,!1),window.addEventListener("keydown",function(t){[32,37,38,39,40].indexOf(t.keyCode)>-1&&t.preventDefault()},!1)}e=t.exports=i,i.prototype={destroy:function(){document.removeEventListener("keydown",this.onKeyDown,!1),document.removeEventListener("keyup",this.onKeyUp,!1)},onKeyChange:function(t,e){var i=t.keyCode;this.keyCodes[i]=e},pressed:function t(e){for(var i=e.split("+"),s=0;s<i.length;s++){var t,n,a=i[s];if(n=Object.keys(this.alias).indexOf(a)!=-1?this.alias[a]:a.toUpperCase().charCodeAt(0),t=this.keyCodes[n],!t)return!1}return!0}}},function(t,e){"use strict";function i(t){this.canvas=t,this.running=!1,this.click=!1,this.angle=0,this.wheel=0,this.canvas.addEventListener("click",function(t){this.onClick(t)}.bind(this)),this.canvas.addEventListener("mousewheel",function(t){this.onMouseWheel(t)}.bind(this))}e=t.exports=i,i.prototype={onClick:function(t){if(this.running){t=t||window.event,this.click="click"==t.type;var e=t.pageX-this.canvas.offsetLeft,i=t.pageY-this.canvas.offsetTop,s=-this.canvas.clientWidth/2+e,n=-this.canvas.clientHeight/2+i;this.angle=Math.atan2(n,s)}},onMouseWheel:function(t,e){this.running&&(t.deltaY>0?this.wheel--:t.deltaY<0&&this.wheel++,t.preventDefault())},wheeled:function t(){var t=this.wheel;return this.wheel=0,t}}},function(t,e){"use strict";function i(t){this.buf=t,this.view=new DataView(this.buf),this.offset=0}t.exports=i,i.prototype={getUint8:function(){var t=this.view.getUint8(this.offset);return this.offset+=1,t},getInt8:function(){var t=this.view.getInt8(this.offset);return this.offset+=1,t},getUint16:function(){var t=this.view.getUint16(this.offset,!0);return this.offset+=2,t},getInt16:function(){var t=this.view.getInt16(this.offset,!0);return this.offset+=2,t},getUint32:function(){var t=this.view.getUint32(this.offset,!0);return this.offset+=4,t},getInt32:function(){var t=this.view.getInt32(this.offset,!0);return this.offset+=4,t},getFloat32:function(){var t=this.view.getFloat32(this.offset,!0);return this.offset+=4,t},getStringUTF8:function(){for(var t="",e=[],i=this.getUint8(),s=0;s<i;s++){var n=this.getUint8();e.push(n)}if(i)try{t=decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}catch(t){}return t},getFlags:function(){var t=this.getUint8(),e=this.fromByte(t);return e},fromByte:function(t){for(var e=new Array(8),i=0;i<8;i++)e[i]=0!==(t&1<<i);return e},addOffset:function(t){this.offset+=t}}},function(t,e){"use strict";function i(){this.bytes=[],this.miniBuf=new ArrayBuffer(4),this.miniView=new DataView(this.miniBuf)}t.exports=i,i.prototype={setUint8:function(t){this.miniView.setUint8(0,t),this.addToBytes(1)},setInt8:function(t){this.miniView.setInt8(0,t),this.addToBytes(1)},setUint16:function(t){this.miniView.setUint16(0,t,!0),this.addToBytes(2)},setInt16:function(t){this.miniView.setInt16(0,t,!0),this.addToBytes(2)},setUint32:function(t){this.miniView.setUint32(0,t,!0),this.addToBytes(4)},setInt32:function(t){this.miniView.setInt32(0,t,!0),this.addToBytes(4)},setFloat32:function(t){this.miniView.setFloat32(0,t,!0),this.addToBytes(4)},setStringUTF8:function(t){if(t&&t.length){var e=unescape(encodeURIComponent(t));this.setUint8(e.length);for(var i=0;i<e.length;i++)this.setUint8(e.charCodeAt(i))}else this.setUint8(0)},setFlags:function(t){var e=this.toByte(t);this.setUint8(e)},toByte:function(t){for(var e=0,i=0;i<t.length;i++)t[i]&&(e|=1<<i);return e},addToBytes:function(t){for(var e=0;e<t;e++)this.bytes.push(this.miniView.getUint8(e));this.clearMiniBuf()},clearMiniBuf:function(){this.miniBuf=new ArrayBuffer(4),this.miniView=new DataView(this.miniBuf)},form:function(){for(var t=new ArrayBuffer(this.bytes.length),e=new DataView(t),i=0;i<this.bytes.length;i++)e.setUint8(i,this.bytes[i]);return t}}},function(t,e,i){"use strict";var s=i(37);s.env="development",t.exports=s},function(t,e,i){"use strict";t.exports={env:"development",serverPort:{NODE_ENV:"production"}.PORT||3e3,serverUrl:"flapzd.herokuapp.com",serverMaxGamers:10,serverMaxSameIp:5,serverLagCompensation:0,serverPacketMaxSize:128,tickMain:50,tickBoard:10,tickPhysics:17,tickState:50,tickScope:8,clientMaxUpdateBuffer:120,clientInterpolationTime:100,clientSmoothingFactor:.3,debug:!1,debugMove:!1,debugZoom:!0,debugTileSize:!1,debugSelfScope:!1,debugBorder:!1,debugFood:!1,debugFoodHitbox:!1,debugSelfHitbox:!1,debugRingHitbox:!1,zoomFactor:1.1,zoomScaleLimit:2.5,scaleMassFactor:.003,selfScopeInitSize:10,selfScopeFactor:.16,playerInitSize:50,playerFactor:.8,ballInitSize:20,ballFactor:.5,ballSpriteInitSize:100,ballSpriteFactor:2,ringInitSize:100,ringFactor:2,ringMaxInitSize:151,ringMaxFactor:4.1,ballTreshold:500,ballSpeed:1.4,ringFreqInit:2e3,ringFreqFactor:20,ringTime:300,scopeRatio:16/9,scopeInitX:896,scopeInitY:504,tileAmountX:100,tileAmountY:100,tileScopeAmountX:17,tileScopeAmountY:11,tileFoodRange:5,minimapRad:50,miniselfRad:3,midLimitRad:3e3,midLimitStroke:1600,midLimitOffset:1400,endLimitRad:1e4,endLimitStroke:1600,endLimitOffset:6e3,mapSize:23200,tunnelHeight:300,playerNameMaxSize:15,playerImmunityTime:1e4,playerVx:152,playerVy:240,playerGravity:660,playerMinMassDash:0,playerInitMass:0,dashSpeed:800,dashMassLoss:1,dashTime:500,dashTxtSize:4,shootInitSize:64,shootTime:1e3,foodInitSize:50,foodMass:500,foodSpawnAmount:500,foodInsideProportion:.5,foodMovingTime:1e3,foodRotationSpeed:.003,foodRotationRadius:5,foodHitbox:30,foodEatenHitbox:8,playerSet:"/client/img/flappy.json",fireballSet:"/client/img/fireball.json",ringImg:"/client/img/firewater.png",shootImg:"/client/img/bullet.png",mapImg:"/client/img/slither.png",bgImg:"/client/img/norik.jpg",foodPaletteSize:9,foodColor0:[242,38,19],foodColor1:[255,149,0],foodColor2b:[255,204,0],foodColor2:[245,215,110],foodColor3:[76,217,100],foodColor4:[102,217,239],foodColor5:[191,85,236],foodColor6:[88,86,214],foodColor7:[249,38,114],foodColor8:[255,144,144],spectatorInitState:{x:0,y:0,mass:0}}},function(t,e){"use strict";function i(){this.filterStrength=20,this.frameTime=0,this.lastLoop=new Date,this.thisLoop=null,this.value=0,this.oldValue=0}e=t.exports=i,i.prototype.setFps=function(t){var e=(this.thisLoop=t)-this.lastLoop;this.frameTime+=(e-this.frameTime)/this.filterStrength,this.lastLoop=this.thisLoop},i.prototype.getFps=function(){return(1e3/this.frameTime).toFixed(1)},i.prototype.startServer=function(){setInterval(function(){this.value=Math.ceil(1e3/this.frameTime),this.value!=this.oldValue&&(console.log(this.value+" FPS"),this.oldValue=this.value)}.bind(this),1e3)}}]);